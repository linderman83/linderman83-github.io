(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{473:function(e,t,a){"use strict";a.r(t);var r=a(16),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("If you plan to use fpm version of Wordpress image from Docker hub bear in mind, that initially you might get PDO related error messages.")]),e._v(" "),a("h2",{attrs:{id:"the-error"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-error"}},[e._v("#")]),e._v(" The Error:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PHP Fatal error:  Uncaught Error: Undefined constant PDO::MYSQL_ATTR_INIT_COMMAND\n")])])]),a("p",[e._v("Without being an expert in PHP or Wordpress, writing this diary, so if another wp/php novice encounter it - to be able to quickly get it fixed.")]),e._v(" "),a("hr"),e._v(" "),a("p",[e._v("Long story short, i was planning to local host Wordpress and proxy it through local Nginx, alongside other servers - already configured there.")]),e._v(" "),a("p",[e._v("Nginx -> Apache -> Wordpress seemed too much for local installation and that's why i decided to use wordpress fpm image:")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/docker-library/wordpress/blob/4d5bd0cc496f7e3976a8535dd670ca6d3763af1d/latest/php8.0/fpm/Dockerfile",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/docker-library/wordpress/blob/4d5bd0cc496f7e3976a8535dd670ca6d3763af1d/latest/php8.0/fpm/Dockerfile"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("All went ok and i proceeded with WooCommerce plugin install until the above error message appear in the container logs. Clearly its PDO mysql driver related.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ php -m\n")])])]),a("p",[e._v("Showed that only "),a("code",[e._v("PDO")]),e._v(" module itself was installed, but no pdo_mysql.")]),e._v(" "),a("p",[e._v("Went to php.ini and in there "),a("code",[e._v(";extension=pdo_mysql")]),e._v(' was commented out - ";". Uncomment, save, restart:')]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\"PHP Warning:  PHP Startup: Unable to load dynamic library 'pdo_mysql'\"\n")])])]),a("p",[e._v("Ah, so the module is not there at all...")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ php -i | grep extension_dir\n")])])]),a("p",[e._v("to locate the extension directory: "),a("code",[e._v("/usr/local/lib/php/extensions/no-debug-non-zts-20200930")]),e._v(".")]),e._v(" "),a("p",[e._v("No pdo_mysql in there. Strange that it is not included by default in the image.")]),e._v(" "),a("p",[e._v("But, there is way to install it with the tools included:")]),e._v(" "),a("h2",{attrs:{id:"temporary-fix"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#temporary-fix"}},[e._v("#")]),e._v(" Temporary fix:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/usr/local/bin/docker-php-ext-install pdo_install\n")])])]),a("h2",{attrs:{id:"permanent-fix"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#permanent-fix"}},[e._v("#")]),e._v(" Permanent fix:")]),e._v(" "),a("p",[e._v("To fix the image permanently i created new Dockerfile, inheriting the original wordpress fpm image:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("FROM wordpress:6.3.2-fpm\n\nRUN apt-get update\n\nRUN /usr/local/bin/docker-php-ext-install pdo_mysql\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("docker-php-ext-*:")]),e._v(" "),a("p",[e._v("/usr/local/bin/docker-php-ext-* are helper scripts included from the official php image. And they give us the possibility to compile & install an extensions from source. Or to uninstall them if we want to go slim.")])]),e._v(" "),a("p",[e._v("Keep in mind that your Wordpress docker installation might work without such errors, depending of the plugins installed and their requirements. In my case the error showed after WooCommerce installation.")])])}),[],!1,null,null,null);t.default=s.exports}}]);